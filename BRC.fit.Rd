% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BRC.R
\name{BRC.fit}
\alias{BRC.fit}
\title{This function implements simultaneously bias reduction and model selection using the R package \pkg{stats}.
The loss function consist of the (-1) times likelihood function and discontinuous penalty functions.
For the minimization, the approximate penalties are employed iteratively. The function also implements the best subset selection by AIC and BIC.}
\usage{
BRC.fit(
  X,
  y,
  family = c("binomial", "poisson", "gaussian"),
  penalty = c("AIC", "BIC", "BRC"),
  K_max = 50,
  k_scale = 2
)
}
\arguments{
\item{X}{The n*p design matrix without an intercept. n is sample size. p is the number of
predictor variables. Note that continuous predictors standardized are used.}

\item{y}{The n*1 response vector. binary data for \code{family="binomial"}, count data for \code{family="poisson"},
quantitative data for \code{family="gaussian"}.}

\item{family}{The type of models to fit the data. \code{family="binomial"} and \code{family="poisson"}
and \code{family='gaussian'} are provided corresponding to the above type of responses.}

\item{penalty}{The type of penalty. Selection by The Akaike information criterion for \code{penalty = "AIC"},
The Bayes information criterion for \code{penalty = "BIC"}, and the proposed bias reduction criterion for \code{penalty = "BRC"}.}

\item{K_max}{The maximum number of iterations in the BR method. the default is 50.}

\item{k_scale}{The parameter increase rate that approximates a discontinuous penalty function with a continuous function.
the default is 2.}
}
\value{
Returns an object with \item{theta}{The estimator includeing the intercept.} \item{theta_cnt}{ The vector of indexes selected by
BR with regularization step.} \item{iter_cnt}{number of iterations.}
}
\description{
This function implements simultaneously bias reduction and model selection using the R package \pkg{stats}.
The loss function consist of the (-1) times likelihood function and discontinuous penalty functions.
For the minimization, the approximate penalties are employed iteratively. The function also implements the best subset selection by AIC and BIC.
}
\examples{
set.seed(0)
n = 200; p = 13; rho = 0.5
corrmat = diag(rep(1-rho, p)) + matrix(rho, p, p)
corrmat[,4] = 0.25
corrmat[4, ] = 0.25
corrmat[4,4] = 1
corrmat[,5] = 0
corrmat[5, ] = 0
corrmat[5,5] = 1
cholmat = chol(corrmat)
x = matrix(rnorm(n*p, mean=0, sd=1), n, p)
x = x\%*\%cholmat
x = apply(x[,1:5], 2, scale)
set.seed(1)
b = c(1,-1,2,2,2)
eta = x[,1:5]\%*\%b
prob = 1-exp(-exp(eta))
y = rbinom(n, 1, prob)
Model <- "binomial"
result <- BRC.fit(x, y, family = Model, penalty ="BRC")
cat("BRC",result$theta,"\n")
cat("BRC",result$theta_ix,"\n")
cat("BRC",result$iter_cnt,"\n")
}
\references{
Maritines, J. M. (2002). Minimization of discontinuous cost functions by smoothing. \emph{Acta Appl. Math.}, \bold{71}, 245--260.
Okumura, H. (2023). Bias reduction and model selection in misspecified models. \emph{Commun. Stat. Theory Methods.}, \bold{52}, 2751-2765.
}
\author{
Hidenori Okumura
}
